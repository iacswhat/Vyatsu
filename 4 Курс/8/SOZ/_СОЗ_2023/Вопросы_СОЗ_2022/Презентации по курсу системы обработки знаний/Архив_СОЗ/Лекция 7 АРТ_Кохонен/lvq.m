clear,
%P = [5.10	4.90	4.70	4.60 7.00 6.40	6.90 5.50 6.30	5.80 7.10 6.30;
 %   3.50	3.00	3.20	3.10 3.20 3.20	3.10 2.30 3.30	2.70 3.00 2.90;
  %  1.40	1.40	1.30	1.50 4.70 4.50	4.90 4.00 6.00	5.10 5.90 5.60;
   % 0.20	0.20	0.20	0.20 1.40 1.50	1.50 1.30 2.50	1.90 2.10 1.80];
P = [5.10	4.90	4.70	4.60	5.00	5.40	4.60	5.00	4.40	4.90 7.00	6.40	6.90	5.50	6.50	5.70	6.30	4.90	6.60	5.20 6.30	5.80	7.10	6.30	6.50	7.60	4.90	7.30	6.70	7.20;
    3.50	3.00	3.20	3.10	3.60	3.90	3.40	3.40	2.90	3.10 3.20	3.20	3.10	2.30	2.80	2.80	3.30	2.40	2.90	2.70 3.30	2.70	3.00	2.90	3.00	3.00	2.50	2.90	2.50	3.60;
    1.40	1.40	1.30	1.50	1.40	1.70	1.40	1.50	1.40	1.50 4.70	4.50	4.90	4.00	4.60	4.50	4.70	3.30	4.60	3.90 6.00	5.10	5.90	5.60	5.80	6.60	4.50	6.30	5.80	6.10;
    0.20	0.20	0.20	0.20	0.20	0.40	0.30	0.20	0.20	0.10 1.40	1.50	1.50	1.30	1.50	1.30	1.60	1.00	1.30	1.40 2.50	1.90	2.10	1.80	2.20	2.10	1.70	1.80	1.80	2.50];
Tc = [1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3];  
%Tc = [1 1 1 1 2 2 2 2 3 3 3 3];
    %I1 = find(Tc==1); 
%I2 = find(Tc==2);  
%figure(1), clf, axis([-4,4,-3,3]), hold on  
%plot(P(1,I1),P(2,I1),'+r')  
%plot(P(1,I2),P(2,I2),'xb') 
T = full(ind2vec(Tc));  
net = newlvq(minmax(P),6,[.33 .33 .34],0.05,'learnlv2');  
%net.inputWeights{1}
net.trainParam.epochs = 100;
net.trainParam.show = 100;
net.trainParam.lr = 0.005;
tic, net = train(net,P,T); toc  
PP = [5.40	4.80	4.80	4.30	5.80	5.70	5.40	5.10	5.70	5.10 5.00	5.90	6.00	6.10	5.60	6.70	5.60	5.80	6.20	5.60 6.50	6.40	6.80	5.70	5.80	6.40	6.50	7.70	7.70	6.00; 
    3.70	3.40	3.00	3.00	4.00	4.40	3.90	3.50	3.80	3.80 2.00	3.00	2.20	2.90	2.90	3.10	3.00	2.70	2.20	2.50 3.20	2.70	3.00	2.50	2.80	3.20	3.00	3.80	2.60	2.20;
    1.50	1.60	1.40	1.10	1.20	1.50	1.30	1.40	1.70	1.50 3.50	4.20	4.00	4.70	3.60	4.40	4.50	4.10	4.50	3.90 5.10	5.30	5.50	5.00	5.10	5.30	5.50	6.70	6.90	5.00;
    0.20	0.20	0.10	0.10	0.20	0.40	0.40	0.30	0.30	0.30 1.00	1.50	1.00	1.40	1.30	1.40	1.50	1.00	1.50	1.10 2.00	1.90	2.10	2.00	2.40	2.30	1.80	2.20	2.30	1.50];
%V = net.IW{1,1}  
%I1 = find(Tc==1); I2 = find(Tc==2);
%figure(1), axis([-4,4,-3,3]), hold on
%P1 = P(:,I1); P2 = P(:,I2);
%plot(P1(1,:),P1(2,:),'+k');
%plot(P2(1,:),P2(2,:),'xb'); 
%plot(V(:,1),V(:,2),'or');
a = sim(net,PP);
%b = sim(net, [-4; 0; 3; 5]);